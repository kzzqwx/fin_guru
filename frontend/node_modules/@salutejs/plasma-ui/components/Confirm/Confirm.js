"use strict";

function _typeof(o) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && "function" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? "symbol" : typeof o; }, _typeof(o); }
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.Confirm = void 0;
var _react = /*#__PURE__*/_interopRequireWildcard( /*#__PURE__*/require("react"));
var _styledComponents = /*#__PURE__*/_interopRequireWildcard( /*#__PURE__*/require("styled-components"));
var _plasmaTokens = /*#__PURE__*/require("@salutejs/plasma-tokens");
var _plasmaCore = /*#__PURE__*/require("@salutejs/plasma-core");
var _utils = /*#__PURE__*/require("../../utils");
var _Button = /*#__PURE__*/require("../Button");
var _TextBox = /*#__PURE__*/require("../TextBox");
var _Cell = /*#__PURE__*/require("../Cell");
var _collectPackageInfo = /*#__PURE__*/require("../../collectPackageInfo");
var _ModalOverlayVariable;
function _getRequireWildcardCache(e) { if ("function" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(e) { return e ? t : r; })(e); }
function _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || "object" != _typeof(e) && "function" != typeof e) return { "default": e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if ("default" !== u && {}.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n["default"] = e, t && t.set(e, n), n; }
(0, _collectPackageInfo.collectPackageInfo)('Confirm/Confirm');
var flexDirection = {
  horizontal: 'row',
  'horizontal-reverse': 'row-reverse',
  vertical: 'column',
  'vertical-reverse': 'column-reverse'
};
var marginByDirection = {
  horizontal: 'margin-right',
  'horizontal-reverse': 'margin-left',
  vertical: 'margin-bottom',
  'vertical-reverse': 'margin-top'
};
var ModalOverlayVariables = /*#__PURE__*/(0, _styledComponents.createGlobalStyle)(["body{--plasma-modal-overlay-color:", ";}"], _plasmaTokens.overlay);
var tvLayout = /*#__PURE__*/(0, _styledComponents.css)(["display:flex;flex-direction:row;justify-content:space-between;align-items:center;"]);
var StyledButton = /*#__PURE__*/(0, _styledComponents["default"])(_Button.Button).withConfig({
  componentId: "plasma-ui__sc-qi6do9-0"
})([""]);

// TODO: https://github.com/salute-developers/plasma/issues/232
var ConfirmRoot = /*#__PURE__*/_styledComponents["default"].div.withConfig({
  componentId: "plasma-ui__sc-qi6do9-1"
})(["", ";"], function (_ref) {
  var stretch = _ref.stretch;
  return stretch && {
    width: '100vw'
  };
});
var ConfirmContainer = /*#__PURE__*/_styledComponents["default"].div.withConfig({
  componentId: "plasma-ui__sc-qi6do9-2"
})(["margin:1rem 1rem 0;padding:0.75rem;border-radius:1.25rem;background-color:", ";"], _plasmaTokens.backgroundPrimary);
var ConfirmMain = /*#__PURE__*/_styledComponents["default"].div.withConfig({
  componentId: "plasma-ui__sc-qi6do9-3"
})(["", " ", "{white-space:pre-line;}", "{white-space:pre-line;}"], function (_ref2) {
  var theme = _ref2.theme;
  return (0, _styledComponents.css)(["", " ", " ", ""], (0, _utils.mediaQuery)('M', theme.deviceScale)(tvLayout), (0, _utils.mediaQuery)('L', theme.deviceScale)(tvLayout), (0, _utils.mediaQuery)('XL', theme.deviceScale)(tvLayout));
}, _TextBox.TextBoxTitle, _TextBox.TextBoxSubTitle);
var ConfirmFooter = /*#__PURE__*/_styledComponents["default"].div.withConfig({
  componentId: "plasma-ui__sc-qi6do9-4"
})(["margin-left:1rem;margin-right:1rem;max-width:100%;"]);
var handleFlexDirection = function handleFlexDirection(_ref3) {
  var reverse = _ref3.reverse,
    direction = _ref3.direction;
  if (reverse) {
    return flexDirection['horizontal-reverse'];
  }
  return flexDirection[direction];
};
var handleMarginByDirection = function handleMarginByDirection(_ref4) {
  var direction = _ref4.direction,
    reverse = _ref4.reverse;
  var margin = reverse ? marginByDirection['horizontal-reverse'] : marginByDirection[direction];
  return (0, _styledComponents.css)(["", ":0.5rem;"], margin);
};
var BtnWrap = /*#__PURE__*/_styledComponents["default"].div.withConfig({
  componentId: "plasma-ui__sc-qi6do9-5"
})(["flex:1;display:flex;flex-direction:", ";", ":not(:last-child){", "}", "{min-width:0;}"], handleFlexDirection, StyledButton, handleMarginByDirection, _plasmaCore.ButtonRoot);

// TODO: https://github.com/salute-developers/plasma/issues/232
var StyledCell = /*#__PURE__*/(0, _styledComponents["default"])(_Cell.Cell).withConfig({
  componentId: "plasma-ui__sc-qi6do9-6"
})(["flex:1;", " & > div{padding:0;}"], function (_ref5) {
  var theme = _ref5.theme;
  return (0, _utils.mediaQuery)('S', theme.deviceScale)((0, _styledComponents.css)(["margin-bottom:0.75rem;"]));
});
var StyledModal = /*#__PURE__*/(0, _styledComponents["default"])(_plasmaCore.ModalBase).withConfig({
  componentId: "plasma-ui__sc-qi6do9-7"
})(["& > .", ",.", "{opacity:1;transition:", ";}&.", " > .", "{opacity:0;}&.", " > .", "{opacity:0;}"], _plasmaCore.popupBaseRootClass, _plasmaCore.modalBaseOverlayClass, function (_ref6) {
  var theme = _ref6.theme;
  return theme.lowPerformance ? 'unset' : 'opacity 0.5s 0.1s';
}, _plasmaCore.endTransitionClass, _plasmaCore.popupBaseRootClass, _plasmaCore.endTransitionClass, _plasmaCore.modalBaseOverlayClass);

/**
 * Сообщение подтверждения действия пользователя.
 */
var Confirm = exports.Confirm = function Confirm(props) {
  var title = props.title,
    subtitle = props.subtitle,
    visible = props.visible,
    _props$stretch = props.stretch,
    stretch = _props$stretch === void 0 ? true : _props$stretch,
    approveText = props.approveText,
    dismissText = props.dismissText,
    _props$view = props.view,
    view = _props$view === void 0 ? 'secondary' : _props$view,
    _props$reverseButtons = props.reverseButtons,
    reverseButtons = _props$reverseButtons === void 0 ? false : _props$reverseButtons,
    extraContent = props.extraContent,
    onApprove = props.onApprove,
    onDismiss = props.onDismiss,
    _props$buttonsDirecti = props.buttonsDirection,
    buttonsDirection = _props$buttonsDirecti === void 0 ? 'horizontal' : _props$buttonsDirecti,
    _props$placement = props.placement,
    placement = _props$placement === void 0 ? 'top' : _props$placement,
    _props$offset = props.offset,
    offset = _props$offset === void 0 ? [0, 0] : _props$offset;
  var onApproveClick = (0, _react.useCallback)(function () {
    onApprove();
  }, [onApprove]);
  var onDismissClick = (0, _react.useCallback)(function () {
    onDismiss && onDismiss();
  }, [onDismiss]);
  var btnRef = (0, _react.useRef)(null);
  var approve = /*#__PURE__*/_react["default"].createElement(StyledButton, {
    size: "s",
    ref: btnRef,
    tabIndex: 0,
    stretch: true,
    view: view,
    text: approveText,
    onClick: onApproveClick
  });
  var dismiss = dismissText ? /*#__PURE__*/_react["default"].createElement(StyledButton, {
    size: "s",
    stretch: true,
    view: "secondary",
    text: dismissText,
    onClick: onDismissClick
  }) : null;
  var buttons = /*#__PURE__*/_react["default"].createElement(BtnWrap, {
    reverse: reverseButtons,
    direction: buttonsDirection
  }, dismiss, approve);
  return /*#__PURE__*/_react["default"].createElement(_plasmaCore.PopupBaseProvider, null, _ModalOverlayVariable || (_ModalOverlayVariable = /*#__PURE__*/_react["default"].createElement(ModalOverlayVariables, null)), /*#__PURE__*/_react["default"].createElement(StyledModal, {
    isOpen: visible,
    withAnimation: true,
    onOverlayClick: onDismissClick,
    zIndex: "1000",
    initialFocusRef: btnRef,
    placement: placement,
    offset: offset
  }, /*#__PURE__*/_react["default"].createElement(ConfirmRoot, {
    visible: true,
    stretch: stretch
  }, /*#__PURE__*/_react["default"].createElement(ConfirmContainer, null, /*#__PURE__*/_react["default"].createElement(ConfirmMain, null, /*#__PURE__*/_react["default"].createElement(StyledCell, {
    content: /*#__PURE__*/_react["default"].createElement(_TextBox.TextBox, {
      title: title,
      subTitle: subtitle
    })
  }), buttons)), /*#__PURE__*/_react["default"].createElement(ConfirmFooter, null, extraContent))));
};