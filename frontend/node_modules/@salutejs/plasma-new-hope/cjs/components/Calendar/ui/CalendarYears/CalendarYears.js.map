{"version":3,"file":"CalendarYears.js","sources":["../../../../../src/components/Calendar/ui/CalendarYears/CalendarYears.tsx"],"sourcesContent":["import React, { useCallback, useEffect, useRef } from 'react';\n\nimport { cx } from '../../../../utils';\nimport { useYears } from '../../hooks';\nimport { classes } from '../../Calendar.tokens';\n\nimport type { CalendarYearsProps } from './CalendarYears.types';\nimport { StyledCalendarYears, StyledFlex, StyledYear, StyledYearRoot } from './CalendarYears.styles';\n\n/**\n * Компонент годов в календаре.\n */\nexport const CalendarYears: React.FC<CalendarYearsProps> = ({\n    date: currentDate,\n    startYear,\n    selectIndexes,\n    outerRefs,\n    onChangeYear,\n    onSetSelected,\n    onKeyDown,\n}) => {\n    const [years, selected] = useYears(currentDate, startYear);\n    const selectedRef = useRef(selected);\n    const onSetSelectedRef = useRef(onSetSelected);\n\n    const handleOnChangeYear = useCallback(\n        (event: React.MouseEvent<HTMLDivElement>) => {\n            /**\n             * нужно вызвать stopImmediatePropagation для случаев, когда\n             * обработчик события onClick навешивается снаружи.\n             * Как, например, в компоненте Popup\n             */\n            event.nativeEvent.stopImmediatePropagation();\n\n            const { year } = event.currentTarget.dataset;\n            onChangeYear(Number(year));\n        },\n        [onChangeYear],\n    );\n\n    const getRefs = useCallback(\n        (element: HTMLDivElement, i: number, j: number) => {\n            outerRefs.current[i][j] = element;\n        },\n        [outerRefs],\n    );\n\n    useEffect(() => {\n        if (selectedRef.current) {\n            onSetSelectedRef.current?.(selectedRef.current);\n        }\n    }, []);\n\n    return (\n        <StyledCalendarYears role=\"grid\" aria-labelledby=\"id-grid-label\" onKeyDown={onKeyDown}>\n            {years.map((year, i) => (\n                <StyledFlex role=\"row\" key={i}>\n                    {year.map(({ yearValue, isSelected, isCurrent }, j) => {\n                        const selectedClass = isSelected ? classes.selectedItem : undefined;\n                        const currentClass = !isSelected && isCurrent ? classes.currentItem : undefined;\n\n                        return (\n                            <StyledYearRoot\n                                className={cx(selectedClass, currentClass, classes.selectableItem)}\n                                ref={(element: HTMLDivElement) => getRefs(element, i, j)}\n                                tabIndex={i === selectIndexes?.[0] && j === selectIndexes?.[1] ? 0 : -1}\n                                onClick={handleOnChangeYear}\n                                data-year={yearValue}\n                                aria-selected={isSelected}\n                                role=\"gridcell\"\n                                key={`StyledYear-${i}-${j}`}\n                                aria-label={String(yearValue)}\n                            >\n                                <StyledYear>{yearValue}</StyledYear>\n                            </StyledYearRoot>\n                        );\n                    })}\n                </StyledFlex>\n            ))}\n        </StyledCalendarYears>\n    );\n};\n"],"names":["CalendarYears","_ref","currentDate","date","startYear","selectIndexes","outerRefs","onChangeYear","onSetSelected","onKeyDown","_useYears","useYears","_useYears2","_slicedToArray","years","selected","selectedRef","useRef","onSetSelectedRef","handleOnChangeYear","useCallback","event","nativeEvent","stopImmediatePropagation","year","currentTarget","dataset","Number","getRefs","element","i","j","current","useEffect","_onSetSelectedRef$cur","call","React","createElement","StyledCalendarYears","role","map","StyledFlex","key","_ref2","yearValue","isSelected","isCurrent","selectedClass","classes","selectedItem","undefined","currentClass","currentItem","StyledYearRoot","className","cx","selectableItem","ref","tabIndex","onClick","concat","String","StyledYear"],"mappings":"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"}