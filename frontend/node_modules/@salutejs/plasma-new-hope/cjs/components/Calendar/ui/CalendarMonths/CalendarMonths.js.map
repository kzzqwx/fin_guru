{"version":3,"file":"CalendarMonths.js","sources":["../../../../../src/components/Calendar/ui/CalendarMonths/CalendarMonths.tsx"],"sourcesContent":["import React, { useCallback, useEffect, useRef } from 'react';\n\nimport { cx } from '../../../../utils';\nimport { useMonths } from '../../hooks';\nimport { classes } from '../../Calendar.tokens';\n\nimport type { CalendarMonthsProps } from './CalendarMonths.types';\nimport { StyledCalendarMonths, StyledFlex, StyledMonth, StyledMonthRoot } from './CalendarMonths.styles';\n\n/**\n * Компонент месяцев в календаре.\n */\nexport const CalendarMonths: React.FC<CalendarMonthsProps> = ({\n    date: currentDate,\n    selectIndexes,\n    outerRefs,\n    onChangeMonth,\n    onSetSelected,\n    onKeyDown,\n}) => {\n    const [months, selected] = useMonths(currentDate);\n    const selectedRef = useRef(selected);\n    const onSetSelectedRef = useRef(onSetSelected);\n\n    const handleOnChangeMonth = useCallback(\n        (event: React.MouseEvent<HTMLDivElement>) => {\n            /**\n             * нужно вызвать stopImmediatePropagation для случаев, когда\n             * обработчик события onClick навешивается снаружи.\n             * Как, например, в компоненте Popup\n             */\n            event.nativeEvent.stopImmediatePropagation();\n\n            const { monthIndex } = event.currentTarget.dataset;\n            onChangeMonth(Number(monthIndex));\n        },\n        [onChangeMonth],\n    );\n\n    const getRefs = useCallback(\n        (element: HTMLDivElement, i: number, j: number) => {\n            outerRefs.current[i][j] = element;\n        },\n        [outerRefs],\n    );\n\n    useEffect(() => {\n        if (selectedRef.current) {\n            onSetSelectedRef.current?.(selectedRef.current);\n        }\n    }, []);\n\n    return (\n        <StyledCalendarMonths role=\"grid\" aria-labelledby=\"id-grid-label\" onKeyDown={onKeyDown}>\n            {months.map((month, i) => (\n                <StyledFlex role=\"row\" key={i}>\n                    {month.map(({ monthName, monthIndex, isSelected, isCurrent, monthFullName }, j) => {\n                        const selectedClass = isSelected ? classes.selectedItem : undefined;\n                        const currentClass = !isSelected && isCurrent ? classes.currentItem : undefined;\n\n                        return (\n                            <StyledMonthRoot\n                                id={`month-test-${i}-${j}`}\n                                className={cx(selectedClass, currentClass, classes.selectableItem)}\n                                ref={(element: HTMLDivElement) => getRefs(element, i, j)}\n                                tabIndex={i === selectIndexes?.[0] && j === selectIndexes?.[1] ? 0 : -1}\n                                onClick={handleOnChangeMonth}\n                                data-month-index={monthIndex}\n                                aria-selected={isSelected}\n                                role=\"gridcell\"\n                                key={`StyledMonth-${i}-${j}`}\n                                aria-label={monthFullName}\n                            >\n                                <StyledMonth>{monthName}</StyledMonth>\n                            </StyledMonthRoot>\n                        );\n                    })}\n                </StyledFlex>\n            ))}\n        </StyledCalendarMonths>\n    );\n};\n"],"names":["CalendarMonths","_ref","currentDate","date","selectIndexes","outerRefs","onChangeMonth","onSetSelected","onKeyDown","_useMonths","useMonths","_useMonths2","_slicedToArray","months","selected","selectedRef","useRef","onSetSelectedRef","handleOnChangeMonth","useCallback","event","nativeEvent","stopImmediatePropagation","monthIndex","currentTarget","dataset","Number","getRefs","element","i","j","current","useEffect","_onSetSelectedRef$cur","call","React","createElement","StyledCalendarMonths","role","map","month","StyledFlex","key","_ref2","monthName","isSelected","isCurrent","monthFullName","selectedClass","classes","selectedItem","undefined","currentClass","currentItem","StyledMonthRoot","id","concat","className","cx","selectableItem","ref","tabIndex","onClick","StyledMonth"],"mappings":"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"}