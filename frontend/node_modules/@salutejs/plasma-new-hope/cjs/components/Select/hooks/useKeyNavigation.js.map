{"version":3,"file":"useKeyNavigation.js","sources":["../../../../src/components/Select/hooks/useKeyNavigation.ts"],"sourcesContent":["import { KeyboardEvent, useCallback, useEffect, useState } from 'react';\n\nimport type { UseKeyNavigationProps } from '../Select.types';\n\nexport const Keys = {\n    Enter: 'Enter',\n    Space: 'Space',\n    Tab: 'Tab',\n    Escape: 'Escape',\n    ArrowLeft: 'ArrowLeft',\n    ArrowRight: 'ArrowRight',\n    ArrowUp: 'ArrowUp',\n    ArrowDown: 'ArrowDown',\n    Backspace: 'Backspace',\n    ShiftLeft: 'ShiftLeft',\n    ShiftRight: 'ShiftRight',\n};\n\nexport const useKeyNavigation = ({\n    controlledRefs: { targetRef, chipsRefs, selectRef, itemsRefs, inputRef },\n    opened,\n    enumerationType,\n    valueType,\n    componentType = 'select',\n    value,\n    search,\n    updateValue,\n    updateOpened,\n}: UseKeyNavigationProps) => {\n    const [selectItemIndex, setSelectItemIndex] = useState(-1);\n    const [selectChipIndex, setSelectChipIndex] = useState(-1);\n\n    useEffect(() => {\n        if (!opened) {\n            setSelectItemIndex(-1);\n            setSelectChipIndex(-1);\n\n            return;\n        }\n\n        itemsRefs?.current?.[selectItemIndex]?.focus();\n    }, [opened]);\n\n    useEffect(() => {\n        itemsRefs?.current?.[selectItemIndex]?.focus();\n    }, [value, search]);\n\n    const onKeyDownTarget = useCallback(\n        (event: KeyboardEvent<HTMLButtonElement | HTMLInputElement>) => {\n            const { code } = event;\n\n            const chipsRefsCount = chipsRefs.current.length;\n            let scrollIntoView = false;\n            let newOpened = opened;\n            let newSelectItemIndex = selectItemIndex;\n            let newSelectChipIndex = selectChipIndex;\n            let focusedItem: HTMLElement | HTMLInputElement | null = null;\n\n            if (code === Keys.Enter || (code === Keys.Space && componentType !== 'combobox')) {\n                event.preventDefault();\n            }\n\n            if (code === Keys.Escape) {\n                newOpened = false;\n                newSelectItemIndex = -1;\n                newSelectChipIndex = -1;\n                focusedItem = targetRef.current;\n            }\n\n            if (code === Keys.ArrowLeft && valueType === 'multiple' && enumerationType === 'chip') {\n                const index = selectChipIndex - 1 <= 0 ? 0 : selectChipIndex - 1;\n\n                newSelectChipIndex = document.activeElement === targetRef.current ? 0 : index;\n                newSelectChipIndex =\n                    document.activeElement === inputRef?.current ? chipsRefsCount - 1 : newSelectChipIndex;\n\n                focusedItem = chipsRefs.current?.[newSelectChipIndex];\n\n                scrollIntoView = true;\n            }\n\n            if (code === Keys.ArrowRight && valueType === 'multiple' && enumerationType === 'chip') {\n                const index = selectChipIndex + 1 === chipsRefsCount ? selectChipIndex : selectChipIndex + 1;\n\n                newSelectChipIndex = document.activeElement === targetRef.current ? 0 : index;\n                focusedItem =\n                    index === selectChipIndex\n                        ? (inputRef?.current as HTMLInputElement)\n                        : chipsRefs.current?.[newSelectChipIndex];\n\n                scrollIntoView = true;\n            }\n\n            if (code === Keys.Backspace && document.activeElement !== inputRef?.current) {\n                const index = selectChipIndex - 1 <= 0 ? 0 : selectChipIndex - 1;\n\n                newSelectChipIndex = chipsRefsCount === 0 ? -1 : index;\n                focusedItem = chipsRefsCount === 0 ? (inputRef || targetRef)?.current : chipsRefs?.current?.[index];\n\n                scrollIntoView = true;\n            }\n\n            if (\n                code === Keys.ArrowUp ||\n                code === Keys.ArrowDown ||\n                (code === Keys.Enter && componentType !== 'combobox') ||\n                (code === Keys.Space && componentType !== 'combobox')\n            ) {\n                newOpened = true;\n                newSelectItemIndex = selectItemIndex === -1 ? 0 : selectItemIndex;\n                focusedItem = itemsRefs.current?.[newSelectItemIndex];\n            }\n\n            // INFO: Для кейсов, когда поведение закрытия может контролироваться снаружи\n            if (code !== Keys.Enter || componentType !== 'combobox') {\n                updateOpened(newOpened, event);\n            }\n\n            setSelectItemIndex(newSelectItemIndex);\n            setSelectChipIndex(newSelectChipIndex);\n\n            focusedItem?.focus();\n\n            if (scrollIntoView) {\n                focusedItem?.scrollIntoView({\n                    behavior: 'smooth',\n                    block: 'center',\n                    inline: 'center',\n                });\n            }\n        },\n        [opened, selectItemIndex, selectChipIndex, valueType, enumerationType, componentType, updateOpened],\n    );\n\n    const onKeyDownSelect = useCallback(\n        (event: KeyboardEvent<HTMLDivElement>) => {\n            const { code, shiftKey } = event;\n\n            const itemsRefsCount = itemsRefs.current.length;\n            const chipsRefsCount = chipsRefs.current.length;\n            let scrollIntoView = false;\n            let newOpened = opened;\n            let newSelectItemIndex = selectItemIndex;\n            let newSelectChipIndex = selectChipIndex;\n            let focusedItem: HTMLElement | HTMLInputElement | null = null;\n\n            if (code === Keys.Enter || code === Keys.Tab) {\n                event.preventDefault();\n            }\n\n            if (code === Keys.Escape) {\n                newOpened = false;\n                newSelectItemIndex = -1;\n                newSelectChipIndex = -1;\n                focusedItem = (inputRef || targetRef).current;\n            }\n\n            if (code === Keys.Tab) {\n                newOpened = false;\n                newSelectItemIndex = -1;\n                newSelectChipIndex = -1;\n                focusedItem = (shiftKey\n                    ? selectRef.current?.previousSibling\n                    : selectRef.current?.nextSibling) as HTMLElement;\n            }\n\n            if (code === Keys.ArrowUp) {\n                newSelectItemIndex = newSelectItemIndex - 1 === -1 ? itemsRefsCount - 1 : newSelectItemIndex - 1;\n                focusedItem = itemsRefs?.current?.[newSelectItemIndex];\n            }\n\n            if (code === Keys.ArrowDown) {\n                newSelectItemIndex = newSelectItemIndex + 1 === itemsRefsCount ? 0 : newSelectItemIndex + 1;\n                focusedItem = itemsRefs?.current?.[newSelectItemIndex];\n            }\n\n            if (\n                (code === Keys.ArrowRight || code === Keys.ArrowLeft) &&\n                valueType === 'multiple' &&\n                enumerationType === 'chip' &&\n                chipsRefsCount\n            ) {\n                newSelectChipIndex = chipsRefsCount - 1;\n                newSelectItemIndex = -1;\n                focusedItem = chipsRefs?.current?.[newSelectChipIndex];\n\n                scrollIntoView = true;\n            }\n\n            if (code === Keys.Enter || (code === Keys.Space && componentType !== 'combobox')) {\n                const item = itemsRefs.current[newSelectItemIndex] as HTMLElement;\n\n                // TODO: #1016\n                // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n                // @ts-ignore\n                if (item.ariaDisabled) {\n                    return;\n                }\n\n                updateValue(item, event);\n\n                newOpened = valueType === 'single' ? false : opened;\n                focusedItem = valueType === 'single' ? targetRef.current : focusedItem;\n            }\n\n            const isValidKeyCode = [\n                Keys.ShiftLeft,\n                Keys.ShiftRight,\n                Keys.ArrowDown,\n                Keys.ArrowLeft,\n                Keys.ArrowRight,\n                Keys.ArrowUp,\n                Keys.Enter,\n                Keys.Escape,\n                Keys.Tab,\n            ].includes(code);\n\n            if (componentType === 'combobox' && !isValidKeyCode) {\n                event.stopPropagation();\n\n                focusedItem = inputRef?.current as HTMLInputElement;\n                newSelectItemIndex = -1;\n                newSelectChipIndex = -1;\n            }\n\n            updateOpened(newOpened, event);\n            setSelectItemIndex(newSelectItemIndex);\n            setSelectChipIndex(newSelectChipIndex);\n\n            focusedItem?.focus();\n\n            if (scrollIntoView) {\n                focusedItem?.scrollIntoView({\n                    behavior: 'smooth',\n                    block: 'center',\n                    inline: 'center',\n                });\n            }\n        },\n        [\n            opened,\n            selectItemIndex,\n            selectChipIndex,\n            valueType,\n            enumerationType,\n            componentType,\n            updateOpened,\n            updateValue,\n        ],\n    );\n\n    return { onKeyDownTarget, onKeyDownSelect } as const;\n};\n"],"names":["Keys","Enter","Space","Tab","Escape","ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Backspace","ShiftLeft","ShiftRight","useKeyNavigation","_ref","_ref$controlledRefs","controlledRefs","targetRef","chipsRefs","selectRef","itemsRefs","inputRef","opened","enumerationType","valueType","_ref$componentType","componentType","value","search","updateValue","updateOpened","_useState","useState","_useState2","_slicedToArray","selectItemIndex","setSelectItemIndex","_useState3","_useState4","selectChipIndex","setSelectChipIndex","useEffect","_itemsRefs$current","current","focus","_itemsRefs$current2","onKeyDownTarget","useCallback","event","_focusedItem","code","chipsRefsCount","length","scrollIntoView","newOpened","newSelectItemIndex","newSelectChipIndex","focusedItem","preventDefault","_chipsRefs$current","index","document","activeElement","_chipsRefs$current2","_ref2","_chipsRefs$current3","_itemsRefs$current3","_focusedItem2","behavior","block","inline","onKeyDownSelect","_focusedItem3","shiftKey","itemsRefsCount","_selectRef$current","_selectRef$current2","previousSibling","nextSibling","_itemsRefs$current4","_itemsRefs$current5","_chipsRefs$current4","item","ariaDisabled","isValidKeyCode","includes","stopPropagation","_focusedItem4"],"mappings":"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"}