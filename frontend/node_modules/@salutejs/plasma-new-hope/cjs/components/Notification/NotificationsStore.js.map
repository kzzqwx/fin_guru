{"version":3,"file":"NotificationsStore.js","sources":["../../../src/components/Notification/NotificationsStore.ts"],"sourcesContent":["import { createStoreon, StoreonStore } from 'storeon';\n\nimport { NotificationProps } from './Notification.types';\n\nexport type NotificationItem = {\n    id: string;\n    isHidden?: boolean;\n};\nexport type NotificationsState = {\n    notifications: NotificationItem[];\n};\nexport type NotificationsEvents = {\n    add: NotificationItem;\n    hide: string;\n    remove: string;\n};\n\n/**\n * Создает хранилищие с ключем `notifications` к массиву с окнами.\n */\nexport const NotificationsStore = createStoreon([\n    (store: StoreonStore<NotificationsState, NotificationsEvents>) => {\n        store.on('@init', () => ({ notifications: [] }));\n\n        store.on('add', ({ notifications }, notif) => {\n            return { notifications: notifications.concat([notif]) };\n        });\n\n        store.on('hide', ({ notifications }, id) => {\n            return {\n                notifications: notifications.map((notif) => (id === notif.id ? { ...notif, isHidden: true } : notif)),\n            };\n        });\n\n        store.on('remove', ({ notifications }, id) => {\n            return { notifications: notifications.filter((notif) => id !== notif.id) };\n        });\n    },\n]);\n\nexport const closeNotification = (id: string, delay = 380) => {\n    const { dispatch } = NotificationsStore;\n\n    dispatch('hide', id);\n    setTimeout(() => dispatch('remove', id), delay);\n};\n\n/**\n * Открыть новое окно.\n * @param props Пропсы всплывающего окна\n * @return Идентификатор нового окна\n */\nexport function addNotification({ id: externalId, ...rest }: NotificationProps, timeout = 2000) {\n    const id = externalId || `plasma-notification-${Date.now()}`;\n    const { dispatch } = NotificationsStore;\n\n    dispatch('add', {\n        ...rest,\n        id,\n        isHidden: false,\n    });\n\n    setTimeout(() => closeNotification(id), timeout);\n\n    return id;\n}\n"],"names":["NotificationsStore","createStoreon","store","on","notifications","_ref","notif","concat","_ref2","id","map","_objectSpread","isHidden","_ref3","filter","closeNotification","delay","arguments","length","undefined","dispatch","setTimeout","addNotification","_ref4","externalId","rest","_objectWithoutProperties","_excluded","timeout","Date","now"],"mappings":"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"}